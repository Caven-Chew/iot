<h2>View Bookings page</h2>
<div id="bookingsTb"></div>

<script src='/js/jquery.min.js'></script>
<script>
    startVideo = (bookingId) => {
        window.location.assign('/video/' + bookingId)
    }
    $(document).ready(function() {
        if (sessionStorage.login !== "user") {
            alert("Please login!")
            window.location.assign('/login')
        }

        $.ajax({
                url: '/api/getbookingbypatientid/' + sessionStorage.id,
                method: "get"
            })
            .done(
                function(data) {
                    if (data.message) {
                        $("#statusMessage").text(data.message)
                    } else if (!data.data || data.data.length === 0) {
                        $("#statusMessage").text("No record fetched")
                    } else {
                        data.data.forEach(function(event) {
                            if (event.status == 'progress') {
                                $("#bookingsTb").append(`
                                    <article>
                                        <p>
                                            ${event.doctorName} - ${event.date} - ${event.date} - ${event.status} - <button onClick="startVideo('${event._id}')">Enter</button>
                                        </p>
                                    </article>
                                `)
                            } else {
                                $("#bookingsTb").append(`
                                    <article>
                                        <p>
                                            ${event.doctorName} - ${event.date} - ${event.date} - ${event.status} - <button disabled>hi</button>
                                        </p>
                                    </article>
                                `)
                            }
                        })
                    }
                }
            )
            .fail(
                function(err) {
                    $("#statusMessage").text(err.responseText)
                }
            )
    })
</script>